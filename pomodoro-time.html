<!DOCTYPE html>
<html lang="id" data-bs-theme="light">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0">
    <title>Pomodoro Timer Pro - Responsif & Animasi</title>
    <!-- Bootstrap 5.3 CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Bootstrap Icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css">
    <!-- Animate CSS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css">
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- AOS Animations -->
    <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">
    <style>
        :root {
            --primary-color: #dc3545;
            --secondary-color: #198754;
            --tertiary-color: #0d6efd;
            --warning-color: #ffc107;
            --light-bg: #f8f9fa;
            --dark-bg: #212529;
            --gradient-1: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --gradient-2: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            --gradient-3: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            --shadow-lg: 0 10px 30px rgba(0, 0, 0, 0.1);
            --shadow-sm: 0 2px 10px rgba(0, 0, 0, 0.05);
            --border-radius: 20px;
            --transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.1);
        }

        [data-bs-theme="dark"] {
            --light-bg: #2d333b;
            --dark-bg: #1c2128;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', system-ui, -apple-system, sans-serif;
            background: var(--light-bg);
            color: var(--bs-body-color);
            min-height: 100vh;
            overflow-x: hidden;
            transition: var(--transition);
        }

        /* Header */
        .main-header {
            background: var(--gradient-1);
            padding: 2rem 0;
            border-radius: 0 0 var(--border-radius) var(--border-radius);
            margin-bottom: 2rem;
            box-shadow: var(--shadow-lg);
            position: relative;
            overflow: hidden;
        }

        .main-header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url("data:image/svg+xml,%3Csvg width='100' height='100' viewBox='0 0 100 100' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M11 18c3.866 0 7-3.134 7-7s-3.134-7-7-7-7 3.134-7 7 3.134 7 7 7zm48 25c3.866 0 7-3.134 7-7s-3.134-7-7-7-7 3.134-7 7 3.134 7 7 7zm-43-7c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zm63 31c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zM34 90c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zm56-76c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zM12 86c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm28-65c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm23-11c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zm-6 60c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm29 22c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zM32 63c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zm57-13c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zm-9-21c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2zM60 91c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2zM35 41c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2zM12 60c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2z' fill='%23ffffff' fill-opacity='0.05' fill-rule='evenodd'/%3E%3C/svg%3E");
        }

        /* Timer Container */
        .timer-container {
            background: var(--bs-body-bg);
            border-radius: var(--border-radius);
            box-shadow: var(--shadow-lg);
            overflow: hidden;
            margin-bottom: 2rem;
            transition: var(--transition);
        }

        /* Cup Animation */
        .cup-container {
            position: relative;
            width: 180px;
            height: 220px;
            margin: 0 auto 2rem;
        }

        @media (max-width: 768px) {
            .cup-container {
                width: 140px;
                height: 180px;
            }
        }

        .cup {
            position: absolute;
            width: 100%;
            height: 100%;
            background: linear-gradient(145deg, #e6e6e6, #ffffff);
            border-radius: 0 0 30px 30px;
            overflow: hidden;
            box-shadow:
                inset 0 -5px 10px rgba(0, 0, 0, 0.1),
                0 10px 20px rgba(0, 0, 0, 0.1);
            border: 6px solid #dee2e6;
            border-top: none;
        }

        .liquid {
            position: absolute;
            bottom: 0;
            width: 100%;
            background: var(--gradient-2);
            transition: height 1s cubic-bezier(0.34, 1.56, 0.64, 1);
            border-radius: 0 0 24px 24px;
        }

        .bubbles {
            position: absolute;
            width: 100%;
            height: 100%;
        }

        .bubble {
            position: absolute;
            background: rgba(255, 255, 255, 0.8);
            border-radius: 50%;
            animation: bubble-rise 3s infinite ease-in;
        }

        @keyframes bubble-rise {
            0% {
                transform: translateY(0) scale(0.3);
                opacity: 0;
            }

            20% {
                opacity: 1;
            }

            90% {
                opacity: 1;
            }

            100% {
                transform: translateY(-150px) scale(1);
                opacity: 0;
            }
        }

        .coffee-steam {
            position: absolute;
            top: -30px;
            width: 100%;
            height: 30px;
        }

        .steam {
            position: absolute;
            background: rgba(255, 255, 255, 0.9);
            border-radius: 50%;
            animation: steam-float 4s infinite ease-out;
        }

        @keyframes steam-float {
            0% {
                transform: translateY(0) scale(0.8);
                opacity: 0;
            }

            30% {
                opacity: 0.9;
            }

            100% {
                transform: translateY(-50px) scale(1.5);
                opacity: 0;
            }
        }

        /* Timer Display */
        .timer-display {
            font-size: clamp(3.5rem, 10vw, 5.5rem);
            font-weight: 800;
            font-family: 'Courier New', monospace;
            text-align: center;
            margin: 1rem 0;
            background: var(--gradient-1);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            letter-spacing: 2px;
        }

        /* Progress Bar */
        .progress {
            height: 12px;
            border-radius: 10px;
            margin: 2rem auto;
            max-width: 500px;
            box-shadow: var(--shadow-sm);
        }

        .progress-bar {
            border-radius: 10px;
            transition: width 1s linear;
            background: var(--gradient-1);
        }

        /* Timer Controls */
        .timer-controls {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 1rem;
            padding: 1rem;
            max-width: 500px;
            margin: 0 auto;
        }

        .btn-timer {
            padding: 0.75rem 1.5rem;
            font-weight: 600;
            border-radius: 50px;
            border: none;
            transition: var(--transition);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
        }

        .btn-timer:hover {
            transform: translateY(-3px);
            box-shadow: 0 7px 15px rgba(0, 0, 0, 0.2);
        }

        .btn-timer:active {
            transform: translateY(-1px);
        }

        /* Cards */
        .stat-card {
            background: var(--bs-body-bg);
            border-radius: var(--border-radius);
            padding: 1.5rem;
            box-shadow: var(--shadow-lg);
            height: 100%;
            transition: var(--transition);
            border: 1px solid var(--bs-border-color);
        }

        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.15);
        }

        /* History List */
        .history-list {
            max-height: 400px;
            overflow-y: auto;
        }

        .history-item {
            background: var(--bs-body-bg);
            border-radius: 15px;
            padding: 1rem;
            margin-bottom: 0.75rem;
            border-left: 4px solid;
            transition: var(--transition);
            border: 1px solid var(--bs-border-color);
        }

        .history-item:hover {
            transform: translateX(5px);
        }

        /* Analytics */
        .analytics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin-bottom: 2rem;
        }

        /* Dark Mode Toggle */
        .theme-toggle {
            position: fixed;
            bottom: 20px;
            right: 20px;
            z-index: 1000;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: var(--shadow-lg);
            cursor: pointer;
            transition: var(--transition);
        }

        .theme-toggle:hover {
            transform: rotate(30deg) scale(1.1);
        }

        /* Mobile Optimizations */
        @media (max-width: 576px) {
            .timer-controls {
                grid-template-columns: 1fr;
            }

            .btn-timer {
                width: 100%;
            }

            .analytics-grid {
                grid-template-columns: 1fr;
            }

            .stat-card {
                padding: 1rem;
            }
        }

        /* Tablet Optimizations */
        @media (min-width: 577px) and (max-width: 992px) {
            .timer-controls {
                grid-template-columns: repeat(2, 1fr);
            }

            .analytics-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        /* Animations */
        .animate-pulse {
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% {
                box-shadow: 0 0 0 0 rgba(220, 53, 69, 0.4);
            }

            70% {
                box-shadow: 0 0 0 15px rgba(220, 53, 69, 0);
            }

            100% {
                box-shadow: 0 0 0 0 rgba(220, 53, 69, 0);
            }
        }

        .fade-in-up {
            animation: fadeInUp 0.6s ease-out;
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Scrollbar Styling */
        ::-webkit-scrollbar {
            width: 8px;
        }

        ::-webkit-scrollbar-track {
            background: var(--light-bg);
            border-radius: 10px;
        }

        ::-webkit-scrollbar-thumb {
            background: var(--gradient-1);
            border-radius: 10px;
        }

        /* Loading Animation */
        .loading-spinner {
            display: inline-block;
            width: 2rem;
            height: 2rem;
            border: 3px solid rgba(0, 0, 0, .1);
            border-radius: 50%;
            border-top-color: var(--primary-color);
            animation: spin 1s ease-in-out infinite;
        }

        @keyframes spin {
            to {
                transform: rotate(360deg);
            }
        }

        /* Toast Notifications */
        .custom-toast {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1050;
            max-width: 300px;
        }

        /* Floating Action Buttons */
        .fab-container {
            position: fixed;
            bottom: 20px;
            left: 20px;
            z-index: 1000;
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .fab {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: var(--shadow-lg);
            cursor: pointer;
            transition: var(--transition);
        }

        .fab:hover {
            transform: scale(1.1);
        }

        /* Empty States */
        .empty-state {
            text-align: center;
            padding: 3rem 1rem;
            color: var(--bs-secondary-color);
        }

        .empty-state i {
            font-size: 4rem;
            margin-bottom: 1rem;
            opacity: 0.5;
        }
    </style>
</head>

<body>
    <!-- Theme Toggle -->
    <div class="theme-toggle bg-primary text-white" id="themeToggle">
        <i class="bi bi-moon-fill fs-5" id="themeIcon"></i>
    </div>

    <!-- Floating Action Buttons -->
    <div class="fab-container">
        <div class="fab bg-success text-white" data-bs-toggle="tooltip" title="Quick Start 25 Min"
            onclick="quickStart(25)">
            <i class="bi bi-lightning-fill"></i>
        </div>
        <div class="fab bg-warning text-dark" data-bs-toggle="tooltip" title="Take a Break" onclick="quickBreak()">
            <i class="bi bi-cup-hot"></i>
        </div>
    </div>

    <!-- Toast Container -->
    <div id="toastContainer" class="custom-toast"></div>

    <div class="container-fluid px-3 px-md-4 px-lg-5">
        <!-- Header -->
        <header class="main-header text-center text-white">
            <div class="container">
                <h1 class="display-4 fw-bold mb-3 animate__animated animate__fadeInDown">
                    <i class="bi bi-hourglass-split"></i> Pomodoro Pro
                </h1>
                <p class="lead mb-4 animate__animated animate__fadeInUp animate__delay-1s">
                    Tingkatkan fokus dan produktivitas dengan teknik Pomodoro yang canggih
                </p>
                <div class="row justify-content-center g-3">
                    <div class="col-auto">
                        <span class="badge bg-light text-dark fs-6">
                            <i class="bi bi-clock"></i> Responsif di Semua Perangkat
                        </span>
                    </div>
                    <div class="col-auto">
                        <span class="badge bg-light text-dark fs-6">
                            <i class="bi bi-graph-up"></i> Analisis Mendalam
                        </span>
                    </div>
                    <div class="col-auto">
                        <span class="badge bg-light text-dark fs-6">
                            <i class="bi bi-bell"></i> Notifikasi Real-time
                        </span>
                    </div>
                </div>
            </div>
        </header>

        <!-- Main Timer Section -->
        <div class="timer-container fade-in-up" data-aos="fade-up">
            <div class="p-4 p-md-5">
                <!-- Timer Visualization -->
                <div class="text-center">
                    <div class="cup-container">
                        <div class="cup">
                            <div class="liquid" id="liquid"></div>
                            <div class="bubbles" id="bubbles"></div>
                            <div class="coffee-steam" id="steam"></div>
                        </div>
                    </div>

                    <div class="timer-display" id="timerDisplay">25:00</div>

                    <div class="d-flex justify-content-center align-items-center mb-4">
                        <span class="badge bg-primary bg-gradient fs-5 px-3 py-2 me-3" id="timerMode">
                            <i class="bi bi-bullseye"></i> Fokus
                        </span>
                        <span class="badge bg-secondary bg-gradient fs-5 px-3 py-2" id="sessionCount">
                            <i class="bi bi-check-circle"></i> 0 Sesi
                        </span>
                    </div>

                    <!-- Progress Bar -->
                    <div class="progress w-75 mx-auto">
                        <div class="progress-bar" id="progressBar" role="progressbar"></div>
                    </div>
                </div>

                <!-- Timer Controls -->
                <div class="timer-controls mt-4">
                    <button class="btn btn-success btn-timer" id="startBtn">
                        <i class="bi bi-play-fill"></i> <span class="d-none d-md-inline">Mulai</span>
                    </button>
                    <button class="btn btn-warning btn-timer" id="pauseBtn" disabled>
                        <i class="bi bi-pause-fill"></i> <span class="d-none d-md-inline">Jeda</span>
                    </button>
                    <button class="btn btn-danger btn-timer" id="resetBtn">
                        <i class="bi bi-arrow-clockwise"></i> <span class="d-none d-md-inline">Reset</span>
                    </button>
                    <button class="btn btn-info btn-timer" id="skipBtn">
                        <i class="bi bi-skip-forward-fill"></i> <span class="d-none d-md-inline">Lewati</span>
                    </button>
                </div>
            </div>
        </div>

        <!-- Stats Cards -->
        <div class="row g-4 mb-4" data-aos="fade-up" data-aos-delay="100">
            <div class="col-md-3 col-sm-6">
                <div class="stat-card text-center">
                    <div class="fs-1 text-primary mb-2">
                        <i class="bi bi-clock-history"></i>
                    </div>
                    <h3 class="h4" id="totalFocusTime">0j 0m</h3>
                    <p class="text-muted mb-0">Total Fokus Hari Ini</p>
                </div>
            </div>
            <div class="col-md-3 col-sm-6">
                <div class="stat-card text-center">
                    <div class="fs-1 text-success mb-2">
                        <i class="bi bi-graph-up-arrow"></i>
                    </div>
                    <h3 class="h4" id="avgFocusTime">0m</h3>
                    <p class="text-muted mb-0">Rata-rata Per Sesi</p>
                </div>
            </div>
            <div class="col-md-3 col-sm-6">
                <div class="stat-card text-center">
                    <div class="fs-1 text-warning mb-2">
                        <i class="bi bi-trophy"></i>
                    </div>
                    <h3 class="h4" id="productivityScore">0%</h3>
                    <p class="text-muted mb-0">Skor Produktivitas</p>
                </div>
            </div>
            <div class="col-md-3 col-sm-6">
                <div class="stat-card text-center">
                    <div class="fs-1 text-info mb-2">
                        <i class="bi bi-calendar-week"></i>
                    </div>
                    <h3 class="h4" id="streakDays">0</h3>
                    <p class="text-muted mb-0">Hari Beruntun</p>
                </div>
            </div>
        </div>

        <!-- Main Content Tabs -->
        <div class="row g-4">
            <!-- Left Column - Settings & History -->
            <div class="col-lg-8">
                <div class="timer-container" data-aos="fade-right">
                    <ul class="nav nav-pills nav-justified mb-4" id="mainTab" role="tablist">
                        <li class="nav-item" role="presentation">
                            <button class="nav-link active" id="settings-tab" data-bs-toggle="pill"
                                data-bs-target="#settings" type="button">
                                <i class="bi bi-gear me-2"></i> Pengaturan
                            </button>
                        </li>
                        <li class="nav-item" role="presentation">
                            <button class="nav-link" id="history-tab" data-bs-toggle="pill" data-bs-target="#history"
                                type="button">
                                <i class="bi bi-clock-history me-2"></i> Riwayat
                            </button>
                        </li>
                        <li class="nav-item" role="presentation">
                            <button class="nav-link" id="analytics-tab" data-bs-toggle="pill"
                                data-bs-target="#analytics" type="button">
                                <i class="bi bi-bar-chart me-2"></i> Analisis
                            </button>
                        </li>
                    </ul>

                    <div class="tab-content p-3 p-md-4">
                        <!-- Settings Tab -->
                        <div class="tab-pane fade show active" id="settings" role="tabpanel">
                            <div class="row g-4">
                                <div class="col-md-6">
                                    <div class="card border-0 shadow-sm h-100">
                                        <div class="card-body">
                                            <h5 class="card-title mb-4">
                                                <i class="bi bi-sliders text-primary"></i> Durasi Timer
                                            </h5>
                                            <div class="mb-4">
                                                <label class="form-label">Fokus (menit)</label>
                                                <div class="d-flex align-items-center">
                                                    <button class="btn btn-outline-primary btn-sm"
                                                        id="decreaseWorkTime">
                                                        <i class="bi bi-dash-lg"></i>
                                                    </button>
                                                    <input type="number" class="form-control text-center mx-2"
                                                        id="workTime" value="25" min="1" max="60">
                                                    <button class="btn btn-outline-primary btn-sm"
                                                        id="increaseWorkTime">
                                                        <i class="bi bi-plus-lg"></i>
                                                    </button>
                                                </div>
                                            </div>
                                            <div class="mb-4">
                                                <label class="form-label">Istirahat Pendek (menit)</label>
                                                <div class="d-flex align-items-center">
                                                    <button class="btn btn-outline-success btn-sm"
                                                        id="decreaseBreakTime">
                                                        <i class="bi bi-dash-lg"></i>
                                                    </button>
                                                    <input type="number" class="form-control text-center mx-2"
                                                        id="breakTime" value="5" min="1" max="30">
                                                    <button class="btn btn-outline-success btn-sm"
                                                        id="increaseBreakTime">
                                                        <i class="bi bi-plus-lg"></i>
                                                    </button>
                                                </div>
                                            </div>
                                            <div>
                                                <label class="form-label">Istirahat Panjang (menit)</label>
                                                <div class="d-flex align-items-center">
                                                    <button class="btn btn-outline-info btn-sm"
                                                        id="decreaseLongBreakTime">
                                                        <i class="bi bi-dash-lg"></i>
                                                    </button>
                                                    <input type="number" class="form-control text-center mx-2"
                                                        id="longBreakTime" value="15" min="5" max="60">
                                                    <button class="btn btn-outline-info btn-sm"
                                                        id="increaseLongBreakTime">
                                                        <i class="bi bi-plus-lg"></i>
                                                    </button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div class="col-md-6">
                                    <div class="card border-0 shadow-sm h-100">
                                        <div class="card-body">
                                            <h5 class="card-title mb-4">
                                                <i class="bi bi-bell text-warning"></i> Notifikasi
                                            </h5>
                                            <div class="mb-3 form-check form-switch">
                                                <input class="form-check-input" type="checkbox" id="soundToggle"
                                                    checked>
                                                <label class="form-check-label" for="soundToggle">Suara
                                                    Notifikasi</label>
                                            </div>
                                            <div class="mb-3 form-check form-switch">
                                                <input class="form-check-input" type="checkbox"
                                                    id="desktopNotifyToggle">
                                                <label class="form-check-label" for="desktopNotifyToggle">Notifikasi
                                                    Desktop</label>
                                            </div>
                                            <div class="mb-4">
                                                <label class="form-label">Sesi sebelum istirahat panjang</label>
                                                <div class="d-flex align-items-center">
                                                    <button class="btn btn-outline-secondary btn-sm"
                                                        id="decreaseSessionsBeforeLongBreak">
                                                        <i class="bi bi-dash-lg"></i>
                                                    </button>
                                                    <input type="number" class="form-control text-center mx-2"
                                                        id="sessionsBeforeLongBreak" value="4" min="1" max="10">
                                                    <button class="btn btn-outline-secondary btn-sm"
                                                        id="increaseSessionsBeforeLongBreak">
                                                        <i class="bi bi-plus-lg"></i>
                                                    </button>
                                                </div>
                                            </div>
                                            <div class="d-grid">
                                                <button class="btn btn-outline-danger" id="clearHistoryBtn">
                                                    <i class="bi bi-trash"></i> Hapus Semua Data
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- History Tab -->
                        <div class="tab-pane fade" id="history" role="tabpanel">
                            <div class="d-flex justify-content-between align-items-center mb-4">
                                <h5 class="mb-0">Riwayat Sesi Terbaru</h5>
                                <div class="btn-group" role="group">
                                    <button type="button" class="btn btn-outline-primary btn-sm active"
                                        data-filter="all">Semua</button>
                                    <button type="button" class="btn btn-outline-primary btn-sm"
                                        data-filter="focus">Fokus</button>
                                    <button type="button" class="btn btn-outline-primary btn-sm"
                                        data-filter="break">Istirahat</button>
                                </div>
                            </div>
                            <div class="history-list" id="historyList">
                                <!-- History items will be loaded here -->
                                <div class="empty-state">
                                    <i class="bi bi-clock-history"></i>
                                    <h6 class="mt-3">Belum ada riwayat</h6>
                                    <p class="text-muted">Mulai timer pertama Anda untuk melihat riwayat di sini</p>
                                </div>
                            </div>
                        </div>

                        <!-- Analytics Tab -->
                        <div class="tab-pane fade" id="analytics" role="tabpanel">
                            <div class="chart-container mb-4">
                                <h5 class="mb-3">Statistik Fokus 7 Hari Terakhir</h5>
                                <canvas id="focusChart" height="250"></canvas>
                            </div>
                            <div class="row g-3">
                                <div class="col-md-6">
                                    <div class="card border-0 shadow-sm">
                                        <div class="card-body">
                                            <h6 class="card-title">Distribusi Waktu</h6>
                                            <canvas id="timeDistributionChart" height="200"></canvas>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="card border-0 shadow-sm">
                                        <div class="card-body">
                                            <h6 class="card-title">Performa Harian</h6>
                                            <div class="d-flex align-items-center mb-3">
                                                <div class="flex-grow-1">
                                                    <div class="progress" style="height: 10px;">
                                                        <div class="progress-bar bg-success" id="todayProgress"
                                                            style="width: 0%"></div>
                                                    </div>
                                                </div>
                                                <span class="ms-3" id="todayPercent">0%</span>
                                            </div>
                                            <div class="text-center">
                                                <h2 class="display-4 fw-bold" id="todayScore">0</h2>
                                                <p class="text-muted mb-0">Poin Hari Ini</p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Right Column - Quick Stats & Tips -->
            <div class="col-lg-4">
                <!-- Daily Goal Card -->
                <div class="timer-container mb-4" data-aos="fade-left" data-aos-delay="100">
                    <div class="p-4">
                        <h5 class="mb-3">
                            <i class="bi bi-target text-danger"></i> Target Harian
                        </h5>
                        <div class="mb-3">
                            <div class="d-flex justify-content-between mb-1">
                                <span>Progress Hari Ini</span>
                                <span id="dailyProgressText">0/4 sesi</span>
                            </div>
                            <div class="progress" style="height: 10px;">
                                <div class="progress-bar bg-danger" id="dailyProgress" style="width: 0%"></div>
                            </div>
                        </div>
                        <div class="input-group mb-3">
                            <input type="number" class="form-control" id="dailyGoal" value="4" min="1" max="20">
                            <span class="input-group-text">sesi/hari</span>
                        </div>
                        <button class="btn btn-danger w-100" onclick="updateDailyGoal()">
                            <i class="bi bi-check-circle"></i> Update Target
                        </button>
                    </div>
                </div>

                <!-- Tips Card -->
                <div class="timer-container" data-aos="fade-left" data-aos-delay="200">
                    <div class="p-4">
                        <h5 class="mb-3">
                            <i class="bi bi-lightbulb text-warning"></i> Tips Produktivitas
                        </h5>
                        <div id="productivityTips">
                            <div class="tip-item mb-3">
                                <div class="d-flex align-items-start">
                                    <i class="bi bi-check-circle-fill text-success me-2 mt-1"></i>
                                    <div>
                                        <small class="fw-bold">Fokus 25 menit</small>
                                        <p class="text-muted small mb-0">Satu sesi fokus optimal adalah 25 menit tanpa
                                            gangguan</p>
                                    </div>
                                </div>
                            </div>
                            <div class="tip-item mb-3">
                                <div class="d-flex align-items-start">
                                    <i class="bi bi-check-circle-fill text-success me-2 mt-1"></i>
                                    <div>
                                        <small class="fw-bold">Istirahat 5 menit</small>
                                        <p class="text-muted small mb-0">Setelah setiap sesi, istirahat 5 menit untuk
                                            mengistirahatkan pikiran</p>
                                    </div>
                                </div>
                            </div>
                            <div class="tip-item">
                                <div class="d-flex align-items-start">
                                    <i class="bi bi-check-circle-fill text-success me-2 mt-1"></i>
                                    <div>
                                        <small class="fw-bold">Istirahat panjang</small>
                                        <p class="text-muted small mb-0">Setelah 4 sesi, ambil istirahat 15-30 menit
                                            untuk hasil optimal</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Footer -->
        <footer class="text-center py-4 mt-4 text-muted">
            <p class="mb-0">
                <i class="bi bi-code-slash"></i> Dibangun dengan Bootstrap 5.3 & Chart.js |
                <i class="bi bi-heart-fill text-danger"></i> Pomodoro Timer Pro v2.0
            </p>
            <small>Â© 2024 - Responsif di semua perangkat dengan animasi modern</small>
        </footer>
    </div>

    <!-- Audio Elements -->
    <audio id="timerSound" preload="auto">
        <source src="https://assets.mixkit.co/sfx/preview/mixkit-alarm-digital-clock-beep-989.mp3" type="audio/mpeg">
    </audio>
    <audio id="completeSound" preload="auto">
        <source src="https://assets.mixkit.co/sfx/preview/mixkit-achievement-bell-600.mp3" type="audio/mpeg">
    </audio>

    <!-- Bootstrap JS Bundle -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <!-- AOS Animations -->
    <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>

    <script>
        // Initialize AOS
        AOS.init({
            duration: 800,
            offset: 100,
            once: true
        });

        // DOM Elements
        const timerDisplay = document.getElementById('timerDisplay');
        const timerMode = document.getElementById('timerMode');
        const progressBar = document.getElementById('progressBar');
        const startBtn = document.getElementById('startBtn');
        const pauseBtn = document.getElementById('pauseBtn');
        const resetBtn = document.getElementById('resetBtn');
        const skipBtn = document.getElementById('skipBtn');
        const sessionCount = document.getElementById('sessionCount');
        const liquid = document.getElementById('liquid');
        const bubbles = document.getElementById('bubbles');
        const steam = document.getElementById('steam');
        const themeToggle = document.getElementById('themeToggle');
        const themeIcon = document.getElementById('themeIcon');
        const historyList = document.getElementById('historyList');

        // Timer Variables
        let timer;
        let isRunning = false;
        let isPaused = false;
        let timeLeft = 25 * 60;
        let totalTime = 25 * 60;
        let currentMode = 'focus';
        let sessionsCompleted = 0;
        let sessionsBeforeLongBreak = 4;
        let dailyGoal = 4;

        // Settings
        let workDuration = 25;
        let breakDuration = 5;
        let longBreakDuration = 15;
        let soundEnabled = true;
        let notificationsEnabled = false;

        // Data Storage
        let focusHistory = [];
        let analyticsData = {
            today: { minutes: 0, sessions: 0 },
            week: [],
            streak: 0
        };

        // Charts
        let focusChart = null;
        let distributionChart = null;

        // Initialize the app
        function initApp() {
            loadFromStorage();
            updateTimerDisplay();
            updateCupAnimation(0);
            updateStats();
            setupEventListeners();
            initializeTooltips();
            requestNotificationPermission();

            // Update UI based on current mode
            updateModeUI();

            // Initialize charts
            setTimeout(() => {
                updateCharts();
            }, 500);
        }

        // Setup event listeners
        function setupEventListeners() {
            startBtn.addEventListener('click', startTimer);
            pauseBtn.addEventListener('click', pauseTimer);
            resetBtn.addEventListener('click', resetTimer);
            skipBtn.addEventListener('click', skipTimer);
            themeToggle.addEventListener('click', toggleTheme);

            // Settings controls
            document.getElementById('decreaseWorkTime').addEventListener('click', () => adjustTime('work', -1));
            document.getElementById('increaseWorkTime').addEventListener('click', () => adjustTime('work', 1));
            document.getElementById('decreaseBreakTime').addEventListener('click', () => adjustTime('break', -1));
            document.getElementById('increaseBreakTime').addEventListener('click', () => adjustTime('break', 1));
            document.getElementById('decreaseLongBreakTime').addEventListener('click', () => adjustTime('longBreak', -1));
            document.getElementById('increaseLongBreakTime').addEventListener('click', () => adjustTime('longBreak', 1));
            document.getElementById('decreaseSessionsBeforeLongBreak').addEventListener('click', () => adjustSetting('sessionsBeforeLongBreak', -1));
            document.getElementById('increaseSessionsBeforeLongBreak').addEventListener('click', () => adjustSetting('sessionsBeforeLongBreak', 1));

            // Input changes
            document.getElementById('workTime').addEventListener('change', (e) => updateSettingFromInput('work', e.target.value));
            document.getElementById('breakTime').addEventListener('change', (e) => updateSettingFromInput('break', e.target.value));
            document.getElementById('longBreakTime').addEventListener('change', (e) => updateSettingFromInput('longBreak', e.target.value));
            document.getElementById('sessionsBeforeLongBreak').addEventListener('change', (e) => updateSettingFromInput('sessions', e.target.value));

            // Toggles
            document.getElementById('soundToggle').addEventListener('change', (e) => soundEnabled = e.target.checked);
            document.getElementById('desktopNotifyToggle').addEventListener('change', (e) => notificationsEnabled = e.target.checked);

            // Clear history
            document.getElementById('clearHistoryBtn').addEventListener('click', clearAllData);

            // History filter
            document.querySelectorAll('[data-filter]').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    document.querySelectorAll('[data-filter]').forEach(b => b.classList.remove('active'));
                    e.target.classList.add('active');
                    filterHistory(e.target.dataset.filter);
                });
            });

            // Daily goal
            document.getElementById('dailyGoal').addEventListener('change', (e) => {
                dailyGoal = parseInt(e.target.value) || 4;
                updateDailyProgress();
                saveToStorage();
            });
        }

        // Initialize Bootstrap tooltips
        function initializeTooltips() {
            const tooltipTriggerList = [].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]'));
            tooltipTriggerList.map(function (tooltipTriggerEl) {
                return new bootstrap.Tooltip(tooltipTriggerEl);
            });
        }

        // Update timer display
        function updateTimerDisplay() {
            const minutes = Math.floor(timeLeft / 60);
            const seconds = timeLeft % 60;
            timerDisplay.textContent = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;

            const progressPercentage = 100 - (timeLeft / totalTime * 100);
            progressBar.style.width = `${progressPercentage}%`;
            progressBar.setAttribute('aria-valuenow', progressPercentage);

            updateCupAnimation(progressPercentage);
        }

        // Update cup animation
        function updateCupAnimation(percentage) {
            liquid.style.height = `${percentage}%`;

            // Set liquid color based on mode
            if (currentMode === 'focus') {
                liquid.style.background = 'linear-gradient(to top, #dc3545, #ff6b6b)';
            } else if (currentMode === 'break') {
                liquid.style.background = 'linear-gradient(to top, #198754, #51cf66)';
            } else {
                liquid.style.background = 'linear-gradient(to top, #0d6efd, #4dabf7)';
            }

            // Generate bubbles
            generateBubbles();

            // Generate steam if percentage is high
            if (percentage > 50) {
                generateSteam();
            }
        }

        // Generate bubbles animation
        function generateBubbles() {
            bubbles.innerHTML = '';
            if (!isRunning) return;

            for (let i = 0; i < 8; i++) {
                const bubble = document.createElement('div');
                bubble.className = 'bubble';

                const size = Math.random() * 15 + 5;
                const left = Math.random() * 80 + 10;
                const delay = Math.random() * 2;

                bubble.style.width = `${size}px`;
                bubble.style.height = `${size}px`;
                bubble.style.left = `${left}%`;
                bubble.style.bottom = '10%';
                bubble.style.animationDelay = `${delay}s`;

                bubbles.appendChild(bubble);
            }
        }

        // Generate steam animation
        function generateSteam() {
            steam.innerHTML = '';
            if (!isRunning) return;

            for (let i = 0; i < 4; i++) {
                const steamElement = document.createElement('div');
                steamElement.className = 'steam';

                const size = Math.random() * 20 + 10;
                const left = Math.random() * 70 + 15;
                const delay = Math.random() * 1.5;

                steamElement.style.width = `${size}px`;
                steamElement.style.height = `${size}px`;
                steamElement.style.left = `${left}%`;
                steamElement.style.animationDelay = `${delay}s`;

                steam.appendChild(steamElement);
            }
        }

        // Start timer
        function startTimer() {
            if (isRunning) return;

            isRunning = true;
            isPaused = false;
            startBtn.disabled = true;
            pauseBtn.disabled = false;

            // Record session start
            recordSessionStart();

            // Add pulse animation
            document.querySelector('.timer-container').classList.add('animate-pulse');

            timer = setInterval(() => {
                timeLeft--;
                updateTimerDisplay();

                if (timeLeft <= 0) {
                    completeTimer();
                }
            }, 1000);
        }

        // Pause timer
        function pauseTimer() {
            if (!isRunning) return;

            clearInterval(timer);
            isRunning = false;
            isPaused = true;
            startBtn.disabled = false;
            pauseBtn.disabled = true;

            // Update button text
            startBtn.innerHTML = '<i class="bi bi-play-fill"></i> <span class="d-none d-md-inline">Lanjutkan</span>';

            // Remove pulse animation
            document.querySelector('.timer-container').classList.remove('animate-pulse');
        }

        // Reset timer
        function resetTimer() {
            clearInterval(timer);
            isRunning = false;
            isPaused = false;

            // Reset to current mode's default time
            resetToCurrentMode();

            // Update UI
            startBtn.disabled = false;
            pauseBtn.disabled = true;
            startBtn.innerHTML = '<i class="bi bi-play-fill"></i> <span class="d-none d-md-inline">Mulai</span>';

            // Remove pulse animation
            document.querySelector('.timer-container').classList.remove('animate-pulse');

            updateTimerDisplay();
        }

        // Skip current timer
        function skipTimer() {
            completeTimer(true);
        }

        // Complete timer
        function completeTimer(skipped = false) {
            clearInterval(timer);
            isRunning = false;

            // Remove pulse animation
            document.querySelector('.timer-container').classList.remove('animate-pulse');

            // Record session end
            recordSessionEnd(skipped);

            // Play sound
            if (soundEnabled) {
                const sound = document.getElementById(skipped ? 'timerSound' : 'completeSound');
                sound.currentTime = 0;
                sound.play();
            }

            // Show notification
            if (notificationsEnabled) {
                showNotification();
            }

            // Show toast
            showToast(
                skipped ? 'Sesi dilewati' : 'Sesi selesai!',
                skipped ? 'Sesi berhasil dilewati' : 'Waktu habis! Saatnya istirahat.',
                skipped ? 'info' : 'success'
            );

            // Switch mode
            switchMode();

            // Update stats
            updateStats();

            // Update charts
            updateCharts();
        }

        // Switch to next mode
        function switchMode() {
            if (currentMode === 'focus') {
                sessionsCompleted++;
                sessionCount.textContent = `${sessionsCompleted} Sesi`;

                if (sessionsCompleted % sessionsBeforeLongBreak === 0) {
                    currentMode = 'longBreak';
                    timeLeft = longBreakDuration * 60;
                    totalTime = longBreakDuration * 60;
                } else {
                    currentMode = 'break';
                    timeLeft = breakDuration * 60;
                    totalTime = breakDuration * 60;
                }
            } else {
                currentMode = 'focus';
                timeLeft = workDuration * 60;
                totalTime = workDuration * 60;
            }

            updateModeUI();
            updateTimerDisplay();
            startBtn.disabled = false;
            pauseBtn.disabled = true;
            startBtn.innerHTML = '<i class="bi bi-play-fill"></i> <span class="d-none d-md-inline">Mulai</span>';
        }

        // Reset to current mode's default time
        function resetToCurrentMode() {
            if (currentMode === 'focus') {
                timeLeft = workDuration * 60;
                totalTime = workDuration * 60;
            } else if (currentMode === 'break') {
                timeLeft = breakDuration * 60;
                totalTime = breakDuration * 60;
            } else {
                timeLeft = longBreakDuration * 60;
                totalTime = longBreakDuration * 60;
            }
        }

        // Update mode UI
        function updateModeUI() {
            const modeConfig = {
                focus: {
                    name: 'Fokus',
                    icon: 'bullseye',
                    color: 'primary',
                    badgeColor: 'primary'
                },
                break: {
                    name: 'Istirahat Pendek',
                    icon: 'cup-hot',
                    color: 'success',
                    badgeColor: 'success'
                },
                longBreak: {
                    name: 'Istirahat Panjang',
                    icon: 'moon',
                    color: 'info',
                    badgeColor: 'info'
                }
            };

            const mode = modeConfig[currentMode];
            timerMode.innerHTML = `<i class="bi bi-${mode.icon}"></i> ${mode.name}`;
            timerMode.className = `badge bg-${mode.badgeColor} bg-gradient fs-5 px-3 py-2 me-3`;

            // Update cup color
            updateCupAnimation(100 - (timeLeft / totalTime * 100));
        }

        // Record session start
        function recordSessionStart() {
            const session = {
                id: Date.now(),
                type: currentMode,
                startTime: Date.now(),
                endTime: null,
                duration: null
            };

            localStorage.setItem('currentSession', JSON.stringify(session));
        }

        // Record session end
        function recordSessionEnd(skipped = false) {
            const sessionStr = localStorage.getItem('currentSession');
            if (!sessionStr) return;

            const session = JSON.parse(sessionStr);
            session.endTime = Date.now();
            session.duration = Math.round((session.endTime - session.startTime) / 1000);
            session.skipped = skipped;

            // Add to history
            focusHistory.unshift(session);

            // Update analytics
            if (session.type === 'focus') {
                const minutes = Math.round(session.duration / 60);
                analyticsData.today.minutes += minutes;
                analyticsData.today.sessions += 1;

                // Update weekly data
                updateWeeklyData(minutes);
            }

            // Save to storage
            saveToStorage();

            // Update history display
            updateHistoryDisplay();

            // Clear current session
            localStorage.removeItem('currentSession');
        }

        // Update weekly data
        function updateWeeklyData(minutes) {
            const today = new Date().toDateString();
            const dayIndex = analyticsData.week.findIndex(day => day.date === today);

            if (dayIndex === -1) {
                analyticsData.week.push({
                    date: today,
                    minutes: minutes,
                    sessions: 1
                });

                // Keep only last 7 days
                if (analyticsData.week.length > 7) {
                    analyticsData.week.shift();
                }
            } else {
                analyticsData.week[dayIndex].minutes += minutes;
                analyticsData.week[dayIndex].sessions += 1;
            }
        }

        // Update stats display
        function updateStats() {
            // Total focus time today
            const totalMinutes = analyticsData.today.minutes;
            const hours = Math.floor(totalMinutes / 60);
            const minutes = totalMinutes % 60;
            document.getElementById('totalFocusTime').textContent = `${hours}j ${minutes}m`;

            // Average focus time
            const avgMinutes = analyticsData.today.sessions > 0 ?
                Math.round(totalMinutes / analyticsData.today.sessions) : 0;
            document.getElementById('avgFocusTime').textContent = `${avgMinutes}m`;

            // Productivity score
            const productivityScore = Math.min(100, Math.round((totalMinutes / 100) * 100));
            document.getElementById('productivityScore').textContent = `${productivityScore}%`;

            // Streak days
            document.getElementById('streakDays').textContent = analyticsData.streak;

            // Update session count
            sessionCount.textContent = `${sessionsCompleted} Sesi`;

            // Update daily progress
            updateDailyProgress();
        }

        // Update daily progress
        function updateDailyProgress() {
            const progress = (sessionsCompleted / dailyGoal) * 100;
            document.getElementById('dailyProgress').style.width = `${Math.min(progress, 100)}%`;
            document.getElementById('dailyProgressText').textContent = `${sessionsCompleted}/${dailyGoal} sesi`;

            // Update today's score
            document.getElementById('todayScore').textContent = sessionsCompleted;
            document.getElementById('todayPercent').textContent = `${Math.round(progress)}%`;
            document.getElementById('todayProgress').style.width = `${Math.min(progress, 100)}%`;
        }

        // Update history display
        function updateHistoryDisplay() {
            if (focusHistory.length === 0) {
                historyList.innerHTML = `
                    <div class="empty-state">
                        <i class="bi bi-clock-history"></i>
                        <h6 class="mt-3">Belum ada riwayat</h6>
                        <p class="text-muted">Mulai timer pertama Anda untuk melihat riwayat di sini</p>
                    </div>`;
                return;
            }

            historyList.innerHTML = '';
            focusHistory.slice(0, 10).forEach(session => {
                const minutes = Math.round(session.duration / 60);
                const typeText = session.type === 'focus' ? 'Fokus' : session.type === 'break' ? 'Istirahat' : 'Istirahat Panjang';
                const typeColor = session.type === 'focus' ? 'danger' : session.type === 'break' ? 'success' : 'info';
                const icon = session.type === 'focus' ? 'bullseye' : session.type === 'break' ? 'cup-hot' : 'moon';

                const time = new Date(session.startTime);
                const timeStr = time.toLocaleTimeString('id-ID', { hour: '2-digit', minute: '2-digit' });

                const historyItem = document.createElement('div');
                historyItem.className = `history-item border-${typeColor}`;
                historyItem.innerHTML = `
                    <div class="d-flex justify-content-between align-items-center">
                        <div>
                            <div class="d-flex align-items-center mb-1">
                                <i class="bi bi-${icon} text-${typeColor} me-2"></i>
                                <strong>${typeText}</strong>
                                ${session.skipped ? '<span class="badge bg-warning ms-2">Dilewati</span>' : ''}
                            </div>
                            <small class="text-muted">${timeStr} â¢ ${minutes} menit</small>
                        </div>
                        <div class="text-${typeColor} fs-5">
                            ${session.type === 'focus' ? '+' + minutes + ' poin' : ''}
                        </div>
                    </div>`;

                historyList.appendChild(historyItem);
            });
        }

        // Filter history
        function filterHistory(filter) {
            const items = historyList.querySelectorAll('.history-item');
            items.forEach(item => {
                const isFocus = item.innerHTML.includes('Fokus');
                const isBreak = item.innerHTML.includes('Istirahat');

                if (filter === 'all' ||
                    (filter === 'focus' && isFocus) ||
                    (filter === 'break' && isBreak)) {
                    item.style.display = 'block';
                } else {
                    item.style.display = 'none';
                }
            });
        }

        // Update charts
        function updateCharts() {
            updateFocusChart();
            updateDistributionChart();
        }

        // Update focus chart
        function updateFocusChart() {
            const ctx = document.getElementById('focusChart').getContext('2d');

            // Prepare data
            const labels = analyticsData.week.map(day => {
                const date = new Date(day.date);
                return date.toLocaleDateString('id-ID', { weekday: 'short' });
            });

            const data = analyticsData.week.map(day => day.minutes);

            // Destroy previous chart
            if (focusChart) {
                focusChart.destroy();
            }

            // Create new chart
            focusChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: labels,
                    datasets: [{
                        label: 'Menit Fokus',
                        data: data,
                        borderColor: '#dc3545',
                        backgroundColor: 'rgba(220, 53, 69, 0.1)',
                        borderWidth: 3,
                        tension: 0.4,
                        fill: true,
                        pointBackgroundColor: '#dc3545',
                        pointBorderColor: '#ffffff',
                        pointBorderWidth: 2,
                        pointRadius: 6
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            display: false
                        },
                        tooltip: {
                            backgroundColor: 'rgba(0, 0, 0, 0.8)',
                            titleColor: '#ffffff',
                            bodyColor: '#ffffff'
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            grid: {
                                color: 'rgba(0, 0, 0, 0.05)'
                            }
                        },
                        x: {
                            grid: {
                                display: false
                            }
                        }
                    }
                }
            });
        }

        // Update distribution chart
        function updateDistributionChart() {
            const ctx = document.getElementById('timeDistributionChart').getContext('2d');

            // Calculate distribution
            const focusTime = analyticsData.today.minutes;
            const otherTime = Math.max(0, 480 - focusTime); // 8 hours in minutes

            // Destroy previous chart
            if (distributionChart) {
                distributionChart.destroy();
            }

            // Create new chart
            distributionChart = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: ['Waktu Fokus', 'Waktu Lainnya'],
                    datasets: [{
                        data: [focusTime, otherTime],
                        backgroundColor: ['#dc3545', '#e9ecef'],
                        borderWidth: 0
                    }]
                },
                options: {
                    responsive: true,
                    cutout: '70%',
                    plugins: {
                        legend: {
                            position: 'bottom'
                        }
                    }
                }
            });
        }

        // Show toast notification
        function showToast(title, message, type = 'info') {
            const toastContainer = document.getElementById('toastContainer');
            const toastId = 'toast-' + Date.now();

            const toast = document.createElement('div');
            toast.className = `toast show border-0 shadow`;
            toast.id = toastId;
            toast.innerHTML = `
                <div class="toast-header bg-${type} text-white border-0">
                    <strong class="me-auto">${title}</strong>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="toast"></button>
                </div>
                <div class="toast-body">
                    ${message}
                </div>`;

            toastContainer.appendChild(toast);

            // Auto remove after 5 seconds
            setTimeout(() => {
                const toastElement = document.getElementById(toastId);
                if (toastElement) {
                    toastElement.remove();
                }
            }, 5000);

            // Initialize Bootstrap toast
            new bootstrap.Toast(toast).show();
        }

        // Show desktop notification
        function showNotification() {
            if (!("Notification" in window)) return;

            if (Notification.permission === "granted") {
                new Notification("Pomodoro Timer Pro", {
                    body: currentMode === 'focus' ?
                        "Waktu fokus selesai! Saatnya istirahat." :
                        "Istirahat selesai! Saatnya fokus kembali.",
                    icon: "https://cdn-icons-png.flaticon.com/512/3208/3208720.png"
                });
            }
        }

        // Request notification permission
        function requestNotificationPermission() {
            if (!("Notification" in window)) return;

            if (Notification.permission === "default") {
                Notification.requestPermission();
            }
        }

        // Toggle dark/light theme
        function toggleTheme() {
            const html = document.documentElement;
            const currentTheme = html.getAttribute('data-bs-theme');
            const newTheme = currentTheme === 'dark' ? 'light' : 'dark';

            html.setAttribute('data-bs-theme', newTheme);
            themeIcon.className = newTheme === 'dark' ? 'bi bi-sun-fill fs-5' : 'bi bi-moon-fill fs-5';

            // Save preference
            localStorage.setItem('theme', newTheme);

            // Show toast
            showToast(
                'Tema Diubah',
                `Berhasil mengubah ke mode ${newTheme === 'dark' ? 'gelap' : 'terang'}`,
                'info'
            );
        }

        // Adjust time settings
        function adjustTime(type, change) {
            let input;
            switch (type) {
                case 'work':
                    input = document.getElementById('workTime');
                    workDuration = Math.max(1, Math.min(60, workDuration + change));
                    input.value = workDuration;
                    break;
                case 'break':
                    input = document.getElementById('breakTime');
                    breakDuration = Math.max(1, Math.min(30, breakDuration + change));
                    input.value = breakDuration;
                    break;
                case 'longBreak':
                    input = document.getElementById('longBreakTime');
                    longBreakDuration = Math.max(5, Math.min(60, longBreakDuration + change));
                    input.value = longBreakDuration;
                    break;
            }

            if (!isRunning && !isPaused) {
                resetToCurrentMode();
                updateTimerDisplay();
            }

            saveToStorage();
        }

        // Adjust other settings
        function adjustSetting(setting, change) {
            const input = document.getElementById('sessionsBeforeLongBreak');
            sessionsBeforeLongBreak = Math.max(1, Math.min(10, sessionsBeforeLongBreak + change));
            input.value = sessionsBeforeLongBreak;
            saveToStorage();
        }

        // Update setting from input
        function updateSettingFromInput(type, value) {
            const numValue = parseInt(value) || 1;
            switch (type) {
                case 'work':
                    workDuration = Math.max(1, Math.min(60, numValue));
                    break;
                case 'break':
                    breakDuration = Math.max(1, Math.min(30, numValue));
                    break;
                case 'longBreak':
                    longBreakDuration = Math.max(5, Math.min(60, numValue));
                    break;
                case 'sessions':
                    sessionsBeforeLongBreak = Math.max(1, Math.min(10, numValue));
                    break;
            }

            if (!isRunning && !isPaused) {
                resetToCurrentMode();
                updateTimerDisplay();
            }

            saveToStorage();
        }

        // Update daily goal
        function updateDailyGoal() {
            const input = document.getElementById('dailyGoal');
            dailyGoal = parseInt(input.value) || 4;
            updateDailyProgress();
            saveToStorage();

            showToast(
                'Target Diperbarui',
                `Target harian diatur menjadi ${dailyGoal} sesi`,
                'success'
            );
        }

        // Quick start function
        function quickStart(minutes) {
            if (isRunning) return;

            workDuration = minutes;
            document.getElementById('workTime').value = minutes;
            currentMode = 'focus';
            resetToCurrentMode();
            updateModeUI();
            updateTimerDisplay();

            showToast(
                'Sesi Cepat',
                `Sesi fokus ${minutes} menit siap dimulai`,
                'info'
            );
        }

        // Quick break function
        function quickBreak() {
            if (isRunning) {
                skipTimer();
            } else {
                currentMode = 'break';
                resetToCurrentMode();
                updateModeUI();
                updateTimerDisplay();

                showToast(
                    'Istirahat Cepat',
                    'Mode istirahat diaktifkan',
                    'info'
                );
            }
        }

        // Clear all data
        function clearAllData() {
            if (!confirm('Apakah Anda yakin ingin menghapus semua data? Tindakan ini tidak dapat dibatalkan.')) {
                return;
            }

            focusHistory = [];
            analyticsData = {
                today: { minutes: 0, sessions: 0 },
                week: [],
                streak: 0
            };
            sessionsCompleted = 0;

            saveToStorage();
            updateHistoryDisplay();
            updateStats();
            updateCharts();

            showToast(
                'Data Dihapus',
                'Semua data berhasil dihapus',
                'warning'
            );
        }

        // Save to localStorage
        function saveToStorage() {
            const data = {
                settings: {
                    workDuration,
                    breakDuration,
                    longBreakDuration,
                    sessionsBeforeLongBreak,
                    soundEnabled,
                    notificationsEnabled,
                    dailyGoal
                },
                analyticsData,
                focusHistory,
                sessionsCompleted,
                theme: document.documentElement.getAttribute('data-bs-theme')
            };

            localStorage.setItem('pomodoroData', JSON.stringify(data));
        }

        // Load from localStorage
        function loadFromStorage() {
            const saved = localStorage.getItem('pomodoroData');
            if (!saved) return;

            const data = JSON.parse(saved);

            // Load settings
            if (data.settings) {
                workDuration = data.settings.workDuration || 25;
                breakDuration = data.settings.breakDuration || 5;
                longBreakDuration = data.settings.longBreakDuration || 15;
                sessionsBeforeLongBreak = data.settings.sessionsBeforeLongBreak || 4;
                soundEnabled = data.settings.soundEnabled !== false;
                notificationsEnabled = data.settings.notificationsEnabled || false;
                dailyGoal = data.settings.dailyGoal || 4;

                // Update inputs
                document.getElementById('workTime').value = workDuration;
                document.getElementById('breakTime').value = breakDuration;
                document.getElementById('longBreakTime').value = longBreakDuration;
                document.getElementById('sessionsBeforeLongBreak').value = sessionsBeforeLongBreak;
                document.getElementById('dailyGoal').value = dailyGoal;
                document.getElementById('soundToggle').checked = soundEnabled;
                document.getElementById('desktopNotifyToggle').checked = notificationsEnabled;
            }

            // Load analytics
            if (data.analyticsData) {
                analyticsData = data.analyticsData;
            }

            // Load history
            if (data.focusHistory) {
                focusHistory = data.focusHistory;
            }

            // Load sessions
            if (data.sessionsCompleted) {
                sessionsCompleted = data.sessionsCompleted;
            }

            // Load theme
            if (data.theme) {
                document.documentElement.setAttribute('data-bs-theme', data.theme);
                themeIcon.className = data.theme === 'dark' ? 'bi bi-sun-fill fs-5' : 'bi bi-moon-fill fs-5';
            }
        }

        // Initialize the app when DOM is loaded
        document.addEventListener('DOMContentLoaded', initApp);

        // Handle visibility change (pause timer when tab is hidden)
        document.addEventListener('visibilitychange', () => {
            if (document.hidden && isRunning) {
                pauseTimer();
                showToast(
                    'Timer Dijeda',
                    'Timer dijeda karena Anda membuka tab lain',
                    'warning'
                );
            }
        });

        // Handle beforeunload
        window.addEventListener('beforeunload', () => {
            if (isRunning) {
                recordSessionEnd(true);
            }
            saveToStorage();
        });
    </script>
</body>

</html>